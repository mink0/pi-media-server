---

version: "2.1"
services:
  #
  # Nginx proxy
  #
  nginx:
    image: linuxserver/nginx
    container_name: nginx
    environment:
      - PUID=$PUID
      - PGID=$PGID
      - TZ=$TZ
    volumes:
      - ./config/nginx/proxy.conf:/config/nginx/proxy.conf
      - ./config/nginx/ssl.conf:/config/nginx/ssl.conf
      - ./config/nginx/site-confs/transmission.subdomain.conf:/config/nginx/site-confs/transmission.subdomain.conf
      - ./config/nginx/site-confs/default:/config/nginx/site-confs/default
    ports:
      - 80:80
      - 443:443
    restart: unless-stopped

  #
  # Transmission
  #
  transmission:
    image: linuxserver/transmission
    container_name: transmission
    environment:
      - PUID=$PUID
      - PGID=$PGID
      - TZ=$TZ
    volumes:
      - $MEDIA_DIR/transmission:/config
      - ./config/transmission/settings.json:/config/settings.json
      - $MEDIA_DIR:/downloads
    ports:
      - 9091:9091
      - 51413:51413
      - 51413:51413/udp
    restart: unless-stopped

  #
  # miniDLNA server
  #
  minidlna:
    image: vladgh/minidlna
    container_name: minidlna
    environment:
      - MINIDLNA_MEDIA_DIR_1=V,/media/movies
      - MINIDLNA_MEDIA_DIR_2=V,/media/tvshows
      - MINIDLNA_MEDIA_DIR_3=V,/media/cartoons
      - MINIDLNA_friendly_name=raspberry
      - MINIDLNA_root_container=V
      - MINIDLNA_inotify=yes
    volumes:
      - $MEDIA_DIR:/media
    network_mode: host
    restart: unless-stopped

